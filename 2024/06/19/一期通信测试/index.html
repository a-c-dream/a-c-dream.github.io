<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6" />
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">

  <script src='https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
  <script src='https://cdn.bootcdn.net/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js'></script>
  <script>
    // 对所有链接跳转事件绑定pjax容器pjax-container 
    $(document).pjax('a', '#pjax-container', {
      fragment: '#pjax-container',
      timeout: 8000
    });   
  </script>
  
  
  <meta name="generator" content="Hexo 5.4.0">

    
      <meta name="description" content="大数据时代的AI">
      

        
          <meta name="keywords" content="AI,CSS,HTML,JavaScript,Hadoop,Hbase,大数据,人工智能">
          

            
              <meta name="author" content="a-c-dream">
              

                

                    

                      <title>
                        
                          一期通信测试 | 
                              a-c-dream
                      </title>

                      

                          
                            <link rel="shortcut icon" href="/icons8-ai-64.png">
                              

                                
                                  <link rel="stylesheet"
                                    href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
                                  <link rel="stylesheet"
                                    href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
                                  

                                    
<link rel="stylesheet" href="/css/style.css">


</head>

<body>




  <div class="root-container" id="pjax-container">
    
<!-- header container -->
<header class="header-container post" id="pjax-container">
  
    <div class="post-image" style="background-image: url(https://images.alphacoders.com/919/919927.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content" id="pjax-container">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          a-c-dream
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">首页</a></li>
        
          <li class="navbar-list-item"><a href="/links">友链</a></li>
        
          <li class="navbar-list-item"><a href="/about">关于</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">一期通信测试</h1>
          <h2 class="title-sub-wrap">
            <strong>a-c-dream</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2024-06-19T06:10:50.790Z" itemprop="datePublished">2024-06-19</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  

</header>

      <!-- 文章 -->
<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <p>nvidia-smi</p>
<p>cnmon</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p><code>ib_send_bw</code>测的是结果是<code>client</code>的</p>
<p><code>ib_write_bw</code>测的是结果是<code>client</code>的</p>
<p><code>ib_read_bw</code>测的是结果是<code>server</code>的</p>
<h3 id="虚拟化rdma"><a href="#虚拟化rdma" class="headerlink" title="虚拟化rdma"></a>虚拟化rdma</h3><p>测试时需要指定对应的master（原因未知）</p>
<h2 id="测试内容"><a href="#测试内容" class="headerlink" title="测试内容"></a>测试内容</h2><ol>
<li>点对点通信（直接用ib perf工具，ib_write_bw和lat）？（这个可以直接测） <ol>
<li>英伟达、海光、寒武纪 </li>
</ol>
</li>
</ol>
<table>
<thead>
<tr>
<th>品牌</th>
<th>ib_send_bw带宽测试</th>
<th>ib_send_lat时延测试</th>
<th>ib_write_bw带宽测试</th>
<th>ib_write_lat时延测试</th>
<th>ib_read_bw带宽测试</th>
<th>ib_read_lat时延测试</th>
</tr>
</thead>
<tbody><tr>
<td>英伟达</td>
<td>3001.70</td>
<td>2681.85</td>
<td>3012.43</td>
<td>2678.63</td>
<td>3005.67</td>
<td>2681.04</td>
</tr>
<tr>
<td>海光</td>
<td>6086.29</td>
<td>1976.92</td>
<td>6086.33</td>
<td>2078.37</td>
<td>6089.41</td>
<td>1317.90</td>
</tr>
<tr>
<td>寒武纪</td>
<td>10943.00</td>
<td>736.30</td>
<td>10943.91</td>
<td>734.52</td>
<td>8661.59</td>
<td>1237.26</td>
</tr>
</tbody></table>
<blockquote>
<p>是否考虑传输size的影响（有些测试用例默认是2-2^23，先固定最大值测-s，之后看需求是否考虑测size影响）</p>
<p>考虑双边语义send和单边语义write,read测试</p>
</blockquote>
<ol start="2">
<li>虚拟化对点对点通信是否影响，现在只有shared rdma方案，只对比这个虚拟化和裸机（对应1）？<ol>
<li>英伟达、海光、寒武纪：在对应的两个node起两个pod挂载rdma，测1中一样的指标：带宽和时延</li>
<li>目前虚拟化，测集合通信，需要装相应的设备，驱动，xccl【这个待定,先不测】</li>
</ol>
</li>
</ol>
<table>
<thead>
<tr>
<th>品牌</th>
<th>ib_send_bw带宽测试</th>
<th>ib_send_lat时延测试</th>
<th>ib_write_bw带宽测试</th>
<th>ib_write_lat时延测试</th>
<th>ib_read_bw带宽测试</th>
<th>ib_read_lat时延测试</th>
</tr>
</thead>
<tbody><tr>
<td>英伟达</td>
<td>2897.57</td>
<td>2702.51</td>
<td>2376.85</td>
<td>2710.28</td>
<td>2920.75</td>
<td>2722.04</td>
</tr>
<tr>
<td>海光</td>
<td>50.78</td>
<td>4238.79</td>
<td>50.97</td>
<td>4298.28</td>
<td>51.05</td>
<td>1318.77</td>
</tr>
<tr>
<td>寒武纪</td>
<td>10833.53</td>
<td>738.25</td>
<td>10889.70</td>
<td>738.22</td>
<td>8659.92</td>
<td>929.08</td>
</tr>
</tbody></table>
<blockquote>
<p>shared后容器中rdma的性能</p>
</blockquote>
<h2 id="网卡信息"><a href="#网卡信息" class="headerlink" title="网卡信息"></a>网卡信息</h2><h3 id="英伟达233"><a href="#英伟达233" class="headerlink" title="英伟达233"></a>英伟达233</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">mlx5_0 port 1 ==&gt; enp1s0np0 (Up)<br>enp1s0np0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000<br>    link/ether 08:c0:eb:cb:10:76 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.2.245/24 brd 192.168.2.255 scope global dynamic noprefixroute enp1s0np0<br>       valid_lft 363433sec preferred_lft 363433sec<br>    inet6 fe80::427c:9f32:747:453f/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br><br>mlx5_3 port 1 ==&gt; enp218s0np0 (Up)<br>enp218s0np0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000<br>    link/ether 08:c0:eb:c8:97:a0 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.2.244/24 brd 192.168.2.255 scope global dynamic noprefixroute enp218s0np0<br>       valid_lft 363433sec preferred_lft 363433sec<br>    inet6 fe80::fcd2:9078:5727:ada9/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br><br></code></pre></td></tr></table></figure>

<h3 id="英伟达232"><a href="#英伟达232" class="headerlink" title="英伟达232"></a>英伟达232</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">mlx5_0 port 1 ==&gt; enp1s0np0 (Up)<br>enp1s0np0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.243  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::65b:b12d:b223:f868  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 08:c0:eb:c7:9a:1e  txqueuelen 1000  (Ethernet)<br>        RX packets 377  bytes 66885 (66.8 KB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 473  bytes 75361 (75.3 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>mlx5_3 port 1 ==&gt; enp218s0np0 (Up)<br>enp218s0np0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.242  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::2967:3c46:51b4:6765  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 08:c0:eb:cb:11:06  txqueuelen 1000  (Ethernet)<br>        RX packets 39  bytes 3760 (3.7 KB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 167  bytes 14142 (14.1 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br></code></pre></td></tr></table></figure>





<h3 id="寒武纪2"><a href="#寒武纪2" class="headerlink" title="寒武纪2"></a>寒武纪2</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mlx5_0</span> port <span class="hljs-number">1</span> ==&gt; ens<span class="hljs-number">121</span>f<span class="hljs-number">0</span>np<span class="hljs-number">0</span> (Up)<br><span class="hljs-attribute">ens121f0np0</span>: flags=<span class="hljs-number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-attribute">inet</span> <span class="hljs-number">192.168.2.247</span>  netmask <span class="hljs-number">255.255.255.0</span>  broadcast <span class="hljs-number">192.168.2.255</span><br>        <span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::ac<span class="hljs-number">0</span>:ebff:fef<span class="hljs-number">6</span>:<span class="hljs-number">193</span>a  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span>&lt;link&gt;<br>        <span class="hljs-attribute">ether</span> <span class="hljs-number">08</span>:c<span class="hljs-number">0</span>:eb:f<span class="hljs-number">6</span>:<span class="hljs-number">19</span>:<span class="hljs-number">3</span>a  txqueuelen <span class="hljs-number">1000</span>  (Ethernet)<br>        <span class="hljs-attribute">RX</span> packets <span class="hljs-number">376662</span>  bytes <span class="hljs-number">50024262</span> (<span class="hljs-number">50</span>.<span class="hljs-number">0</span> MB)<br>        <span class="hljs-attribute">RX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        <span class="hljs-attribute">TX</span> packets <span class="hljs-number">522</span>  bytes <span class="hljs-number">34660</span> (<span class="hljs-number">34</span>.<span class="hljs-number">6</span> KB)<br>        <span class="hljs-attribute">TX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br><br><br><span class="hljs-attribute">mlx5_1</span> port <span class="hljs-number">1</span> ==&gt; ens<span class="hljs-number">121</span>f<span class="hljs-number">1</span>np<span class="hljs-number">1</span> (Up)<br><span class="hljs-attribute">ens121f1np1</span>: flags=<span class="hljs-number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-attribute">inet</span> <span class="hljs-number">192.168.2.248</span>  netmask <span class="hljs-number">255.255.255.0</span>  broadcast <span class="hljs-number">192.168.2.255</span><br>        <span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::ac<span class="hljs-number">0</span>:ebff:fef<span class="hljs-number">6</span>:<span class="hljs-number">193</span>b  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span>&lt;link&gt;<br>        <span class="hljs-attribute">ether</span> <span class="hljs-number">08</span>:c<span class="hljs-number">0</span>:eb:f<span class="hljs-number">6</span>:<span class="hljs-number">19</span>:<span class="hljs-number">3</span>b  txqueuelen <span class="hljs-number">1000</span>  (Ethernet)<br>        <span class="hljs-attribute">RX</span> packets <span class="hljs-number">376823</span>  bytes <span class="hljs-number">50048794</span> (<span class="hljs-number">50</span>.<span class="hljs-number">0</span> MB)<br>        <span class="hljs-attribute">RX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        <span class="hljs-attribute">TX</span> packets <span class="hljs-number">1072</span>  bytes <span class="hljs-number">96910</span> (<span class="hljs-number">96</span>.<span class="hljs-number">9</span> KB)<br>        <span class="hljs-attribute">TX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>

<h3 id="寒武纪1"><a href="#寒武纪1" class="headerlink" title="寒武纪1"></a>寒武纪1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">mlx5_0 port 1 ==&gt; ens121f0np0 (Up)<br>ens121f0np0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.251  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::ac0:ebff:feb6:e7c4  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 08:c0:eb:b6:e7:c4  txqueuelen 1000  (Ethernet)<br>        RX packets 461801  bytes 61249363 (61.2 MB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 718  bytes 47417 (47.4 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>mlx5_1 port 1 ==&gt; ens121f1np1 (Up)<br>ens121f1np1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.254  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::ac0:ebff:feb6:e7c5  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 08:c0:eb:b6:e7:c5  txqueuelen 1000  (Ethernet)<br>        RX packets 460924  bytes 61209639 (61.2 MB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 1157  bytes 103323 (103.3 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br></code></pre></td></tr></table></figure>

<h3 id="海光1"><a href="#海光1" class="headerlink" title="海光1"></a>海光1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">mlx5_0 port 1 ==&gt; ens61f0np0 (Up)<br>ens61f0np0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.241  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::7376:ffd5:d1a2:d4b  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 0c:42:a1:df:c8:44  txqueuelen 1000  (Ethernet)<br>        RX packets 56  bytes 6579 (6.5 KB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 134  bytes 13257 (13.2 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br><br><br>mlx5_1 port 1 ==&gt; ens61f1np1 (Up)<br>ens61f1np1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.240  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::44fe:b707:6be6:be40  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether 0c:42:a1:df:c8:45  txqueuelen 1000  (Ethernet)<br>        RX packets 50  bytes 6139 (6.1 KB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 88  bytes 9995 (9.9 KB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br></code></pre></td></tr></table></figure>



<h3 id="海光2"><a href="#海光2" class="headerlink" title="海光2"></a>海光2</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mlx5_0</span> port <span class="hljs-number">1</span> ==&gt; ens<span class="hljs-number">61</span>f<span class="hljs-number">0</span>np<span class="hljs-number">0</span> (Up)<br><span class="hljs-attribute">ens61f0np0</span>: flags=<span class="hljs-number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-attribute">inet</span> <span class="hljs-number">192.168.2.249</span>  netmask <span class="hljs-number">255.255.255.0</span>  broadcast <span class="hljs-number">192.168.2.255</span><br>        <span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::bace:f<span class="hljs-number">6</span>ff:fe<span class="hljs-number">05</span>:ee<span class="hljs-number">32</span>  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span>&lt;link&gt;<br>        <span class="hljs-attribute">ether</span> b<span class="hljs-number">8</span>:ce:f<span class="hljs-number">6</span>:<span class="hljs-number">05</span>:ee:<span class="hljs-number">32</span>  txqueuelen <span class="hljs-number">1000</span>  (Ethernet)<br>        <span class="hljs-attribute">RX</span> packets <span class="hljs-number">321138</span>  bytes <span class="hljs-number">42634072</span> (<span class="hljs-number">42</span>.<span class="hljs-number">6</span> MB)<br>        <span class="hljs-attribute">RX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        <span class="hljs-attribute">TX</span> packets <span class="hljs-number">695</span>  bytes <span class="hljs-number">44455</span> (<span class="hljs-number">44</span>.<span class="hljs-number">4</span> KB)<br>        <span class="hljs-attribute">TX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br><br><span class="hljs-attribute">mlx5_1</span> port <span class="hljs-number">1</span> ==&gt; ens<span class="hljs-number">61</span>f<span class="hljs-number">1</span>np<span class="hljs-number">1</span> (Up)<br><span class="hljs-attribute">ens61f1np1</span>: flags=<span class="hljs-number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-attribute">inet</span> <span class="hljs-number">192.168.2.250</span>  netmask <span class="hljs-number">255.255.255.0</span>  broadcast <span class="hljs-number">192.168.2.255</span><br>        <span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::bace:f<span class="hljs-number">6</span>ff:fe<span class="hljs-number">05</span>:ee<span class="hljs-number">33</span>  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span>&lt;link&gt;<br>        <span class="hljs-attribute">ether</span> b<span class="hljs-number">8</span>:ce:f<span class="hljs-number">6</span>:<span class="hljs-number">05</span>:ee:<span class="hljs-number">33</span>  txqueuelen <span class="hljs-number">1000</span>  (Ethernet)<br>        <span class="hljs-attribute">RX</span> packets <span class="hljs-number">321297</span>  bytes <span class="hljs-number">42650409</span> (<span class="hljs-number">42</span>.<span class="hljs-number">6</span> MB)<br>        <span class="hljs-attribute">RX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        <span class="hljs-attribute">TX</span> packets <span class="hljs-number">845</span>  bytes <span class="hljs-number">55375</span> (<span class="hljs-number">55</span>.<span class="hljs-number">3</span> KB)<br>        <span class="hljs-attribute">TX</span> errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure>

<h2 id="rdma-share测试pod"><a href="#rdma-share测试pod" class="headerlink" title="rdma_share测试pod"></a>rdma_share测试pod</h2><p>test-cx5-bond-pod1.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">mofed-test-cx5-bond-pod1</span><br>  <span class="hljs-attr">annotations:</span><br>    <span class="hljs-attr">k8s.v1.cni.cncf.io/networks:</span> <span class="hljs-string">default/macvlan-cx5-bond-conf</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">nodeName:</span> <span class="hljs-string">disai-4090-2</span><br>  <span class="hljs-attr">restartPolicy:</span> <span class="hljs-string">OnFailure</span><br>  <span class="hljs-attr">containers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/szy_is_me/rping-test</span><br>    <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">mofed-test-ctr</span><br>    <span class="hljs-attr">securityContext:</span><br>      <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">capabilities:</span><br>        <span class="hljs-attr">add:</span> [ <span class="hljs-string">&quot;IPC_LOCK&quot;</span> ]<br>    <span class="hljs-attr">resources:</span><br>      <span class="hljs-attr">limits:</span><br>        <span class="hljs-attr">rdma/cx5_bond_shared_devices_a:</span> <span class="hljs-number">1</span><br>      <span class="hljs-attr">requests:</span><br>        <span class="hljs-attr">rdma/cx5_bond_shared_devices_a:</span> <span class="hljs-number">1</span><br>    <span class="hljs-attr">command:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">sh</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">-c</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">|</span><br><span class="hljs-string">      ls -l /dev/infiniband /sys/class/infiniband /sys/class/net</span><br><span class="hljs-string">      sleep 1000000</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p>test-cx5-bond-pod2.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">mofed-test-cx5-bond-pod2</span><br>  <span class="hljs-attr">annotations:</span><br>    <span class="hljs-attr">k8s.v1.cni.cncf.io/networks:</span> <span class="hljs-string">default/macvlan-cx5-bond-conf</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">nodeName:</span> <span class="hljs-string">disai-4090-3</span><br>  <span class="hljs-attr">restartPolicy:</span> <span class="hljs-string">OnFailure</span><br>  <span class="hljs-attr">containers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/szy_is_me/rping-test</span><br>    <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">mofed-test-ctr</span><br>    <span class="hljs-attr">securityContext:</span><br>      <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">capabilities:</span><br>        <span class="hljs-attr">add:</span> [ <span class="hljs-string">&quot;IPC_LOCK&quot;</span> ]<br>    <span class="hljs-attr">resources:</span><br>      <span class="hljs-attr">limits:</span><br>        <span class="hljs-attr">rdma/cx5_bond_shared_devices_a:</span> <span class="hljs-number">1</span><br>      <span class="hljs-attr">requests:</span><br>        <span class="hljs-attr">rdma/cx5_bond_shared_devices_a:</span> <span class="hljs-number">1</span><br>    <span class="hljs-attr">command:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">sh</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">-c</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">|</span><br><span class="hljs-string">      ls -l /dev/infiniband /sys/class/infiniband /sys/class/net</span><br><span class="hljs-string">      sleep 1000000</span><br></code></pre></td></tr></table></figure>



<h2 id="ib-send-bw带宽测试"><a href="#ib-send-bw带宽测试" class="headerlink" title="ib_send_bw带宽测试"></a>ib_send_bw带宽测试</h2><h3 id="默认"><a href="#默认" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp"><a href="#海光2-amp" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><p>1</p>
<p>2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -i 1 -s  8388608 <br>ib_send_bw -d mlx5_0 -i 1 -s  8388608 192.168.2.241<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@disai-hygon-2:~$ ib_send_bw -d mlx5_0 -i 1 -s  8388608 192.168.2.241<br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x00cf PSN 0xd29bec<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:249<br> remote address: LID 0000 QPN 0x0074 PSN 0x54bdf5<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br>Conflicting CPU frequency values detected: 2300.097000 != 2485.220000. CPU Frequency is not max.<br> 8388608    1000             6086.30            6086.29		   0.000761<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>

<h4 id="寒武纪2-amp"><a href="#寒武纪2-amp" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪1</p>
<p>寒武纪2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -i 1 -s 8388608<br>ib_send_bw -d mlx5_0 -i 1 -s 8388608 192.168.2.251<br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-Cambricon-2:~$ ib_send_bw -d mlx5_0 -i 1 -s 8388608 192.168.2.251<br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0622 PSN 0xb4b3bc<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:247<br> remote address: LID 0000 QPN 0x0054 PSN 0x79882c<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:251<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br>Conflicting CPU frequency values detected: 3300.000000 != 800.000000. CPU Frequency is not max.<br> 8388608    1000             10943.14            10943.00		   0.001368<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>

<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">---------------------------------------------------------------------------------------</span><br><span class="hljs-code"> #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br><span class="hljs-code">Conflicting CPU frequency values detected: 3276.155000 != 3105.174000. CPU Frequency is not max.</span><br><span class="hljs-code"> 33554432    1000             11615.25            11537.82		   0.000361</span><br><span class="hljs-code">---------------------------------------------------------------------------------------</span><br><br></code></pre></td></tr></table></figure>

<h4 id="NV-amp"><a href="#NV-amp" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -i 1 -s 8388608<br>ib_send_bw -d mlx5_0 -i 1 -s 8388608 192.168.2.245<br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-4090-2:~/rdma/rdma_share$ ib_send_bw -d mlx5_0 -i 1 -s 8388608 192.168.2.245<br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01e0 PSN 0x844016<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br> remote address: LID 0000 QPN 0x011f PSN 0x7b33e3<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br>Conflicting CPU frequency values detected: 1199.999000 != 3840.929000. CPU Frequency is not max.<br> 8388608    1000             3001.70            3001.70		   0.000375<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>

<h3 id="rdma-share"><a href="#rdma-share" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="海光"><a href="#海光" class="headerlink" title="海光"></a>海光</h4><p>1</p>
<p>2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -F --report_gbits -s 8388608<br>ib_send_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_send_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75</span><br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x014c PSN 0x2b47c4<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br> remote address: LID 0000 QPN 0x00f3 PSN 0xf62bf2<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]</span><br> 8388608    1000             51.02              50.78  		   0.000757<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="寒武纪"><a href="#寒武纪" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -i 1 -s  8388608<br>ib_send_bw -d mlx5_0 -i 1 -s  8388608 10.56.217.78<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_send_bw -d mlx5_0 -i 1 -s  8388608 10.56.217.78</span><br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05ba PSN 0xd728e5<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x0047 PSN 0xd728e5<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br>Conflicting CPU frequency values detected: 3300.000000 != 800.000000. CPU Frequency is not max.<br> 8388608    1000             10833.57            10833.53		   0.001354<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="NV"><a href="#NV" class="headerlink" title="NV"></a>NV</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_bw -d mlx5_0 -F -s 8388608<br>ib_send_bw -d mlx5_0 -F -s 8388608 10.56.217.71<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_send_bw -d mlx5_0 -F -s 8388608 10.56.217.71</span><br>---------------------------------------------------------------------------------------<br>                    Send BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01ec PSN 0x3caa42<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br> remote address: LID 0000 QPN 0x012f PSN 0x9dd6ef<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 8388608    1000             2897.57            2897.57		   0.000362<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h2 id="ib-send-lat时延测试"><a href="#ib-send-lat时延测试" class="headerlink" title="ib_send_lat时延测试"></a>ib_send_lat时延测试</h2><h3 id="默认-1"><a href="#默认-1" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp-1"><a href="#海光2-amp-1" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><p>1</p>
<p>2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -d mlx5_0 -a -F<br>ib_send_lat -d mlx5_0 -i 1 192.168.2.241  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@disai-hygon-2:~$ ib_send_lat -d mlx5_0 -i 1 192.168.2.241  -a -F <br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 236[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x00d1 PSN 0xd0a9c9<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:249<br> remote address: LID 0000 QPN 0x0076 PSN 0xbf52ef<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.14           7.26         2.17     	       2.17        	0.10   		2.21    		7.26   <br> 4       1000          2.14           4.30         2.17     	       2.17        	0.03   		2.20    		4.30   <br> 8       1000          2.14           4.18         2.17     	       2.17        	0.03   		2.20    		4.18   <br> 16      1000          2.15           5.40         2.18     	       2.18        	0.03   		2.22    		5.40   <br> 32      1000          2.16           5.70         2.18     	       2.19        	0.03   		2.22    		5.70   <br> 64      1000          2.21           4.29         2.25     	       2.25        	0.03   		2.28    		4.29   <br> 128     1000          2.27           6.17         2.30     	       2.31        	0.06   		2.35    		6.17   <br> 256     1000          2.79           5.33         2.83     	       2.83        	0.00   		2.86    		5.33   <br> 512     1000          2.88           6.21         2.92     	       2.93        	0.05   		2.96    		6.21   <br> 1024    1000          3.03           4.74         3.07     	       3.07        	0.00   		3.11    		4.74   <br> 2048    1000          3.24           7.48         3.29     	       3.30        	0.04   		3.34    		7.48   <br> 4096    1000          3.57           6.76         3.63     	       3.64        	0.04   		3.68    		6.76   <br> 8192    1000          4.15           8.46         4.21     	       4.24        	0.08   		4.41    		8.46   <br> 16384   1000          5.33           5.77         5.39     	       5.39        	0.00   		5.48    		5.77   <br> 32768   1000          7.71           45.11        7.79     	       7.80        	0.10   		7.97    		45.11  <br> 65536   1000          12.39          16.24        12.46    	       12.48       	0.09   		12.65   		16.24  <br> 131072  1000          22.29          23.48        22.35    	       22.36       	0.03   		22.41   		23.48  <br> 262144  1000          41.45          49.19        41.52    	       41.53       	0.16   		41.60   		49.19  <br> 524288  1000          79.62          93.10        79.76    	       79.77       	0.21   		79.91   		93.10  <br> 1048576 1000          155.84         209.94       166.57   	       167.90      	9.08   		186.84  		209.94 <br> 2097152 1000          308.27         1960.04      320.01   	       317.79      	36.21  		401.02  		1960.04<br> 4194304 1000          635.66         3636.32      648.92   	       672.78      	188.09 		1270.92 		3636.32<br> 8388608 1000          1601.17        7919.81      1723.47  	       1976.92     	648.98 		5751.63 		7919.81<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>

<h4 id="寒武纪2-amp-1"><a href="#寒武纪2-amp-1" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪1</p>
<p>寒武纪2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -R  -d mlx5_0 -a -F<br>ib_send_lat -R  -d mlx5_0 -i 1 192.168.2.251  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-Cambricon-2:~$ ib_send_lat -R  -d mlx5_0 -i 1 192.168.2.251  -a -F  <br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 236[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x064e PSN 0xd3c7c2<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:248<br> remote address: LID 0000 QPN 0x0056 PSN 0x3f781<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:251<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.14           6.09         2.19     	       2.20        	0.04   		2.37    		6.09   <br> 4       1000          2.14           5.46         2.19     	       2.20        	0.04   		2.34    		5.46   <br> 8       1000          2.13           3.89         2.19     	       2.20        	0.05   		2.35    		3.89   <br> 16      1000          2.14           6.01         2.20     	       2.21        	0.08   		2.37    		6.01   <br> 32      1000          2.15           5.18         2.21     	       2.22        	0.06   		2.36    		5.18   <br> 64      1000          2.21           3.89         2.26     	       2.27        	0.03   		2.46    		3.89   <br> 128     1000          2.25           5.77         2.32     	       2.36        	0.00   		3.02    		5.77   <br> 256     1000          2.94           6.38         3.01     	       3.02        	0.00   		3.23    		6.38   <br> 512     1000          3.05           6.59         3.12     	       3.14        	0.05   		3.33    		6.59   <br> 1024    1000          3.16           5.88         3.22     	       3.28        	0.03   		3.60    		5.88   <br> 2048    1000          3.28           8.50         3.37     	       3.40        	0.08   		3.68    		8.50   <br> 4096    1000          3.45           6.97         3.56     	       3.58        	0.07   		3.82    		6.97   <br> 8192    1000          3.81           4.73         3.91     	       3.91        	0.00   		4.08    		4.73   <br> 16384   1000          4.50           6.97         4.57     	       4.65        	0.08   		5.06    		6.97   <br> 32768   1000          5.91           7.72         6.02     	       6.07        	0.00   		6.47    		7.72   <br> 65536   1000          8.74           11.91        8.84     	       8.92        	0.12   		9.94    		11.91  <br> 131072  1000          14.64          16.65        14.90    	       14.92       	0.07   		15.32   		16.65  <br> 262144  1000          26.01          34.99        26.38    	       26.39       	0.11   		27.58   		34.99  <br> 524288  1000          48.57          51.91        49.15    	       49.18       	0.15   		50.56   		51.91  <br> 1048576 1000          94.24          98.97        95.15    	       95.20       	0.21   		97.01   		98.97  <br> 2097152 1000          185.60         195.19       186.69   	       186.77      	0.31   		188.65  		195.19 <br> 4194304 1000          368.42         379.03       370.11   	       370.19      	0.51   		372.58  		379.03 <br> 8388608 1000          734.02         740.90       736.16   	       736.30      	0.71   		738.96  		740.90 <br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="NV-amp-1"><a href="#NV-amp-1" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -R  -d mlx5_0 -a -F<br>ib_send_lat -R  -d mlx5_0 -i 1 192.168.2.245  -a -F  <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-4090-2:~/nccl_test/nccl-tests$ ib_send_lat -R  -d mlx5_0 -i 1 192.168.2.245  -a -F  <br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 236[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01e2 PSN 0x55c86e<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br> remote address: LID 0000 QPN 0x0121 PSN 0x624ee<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.27           9.83         2.33     	       2.34        	0.16   		2.43    		9.83   <br> 4       1000          2.25           9.01         2.28     	       2.34        	0.47   		6.85    		9.01   <br> 8       1000          2.25           9.46         2.28     	       2.32        	0.42   		2.43    		9.46   <br> 16      1000          2.26           9.52         2.30     	       2.31        	0.23   		2.48    		9.52   <br> 32      1000          2.29           9.15         2.32     	       2.35        	0.32   		3.18    		9.15   <br> 64      1000          2.36           8.70         2.40     	       2.43        	0.31   		2.78    		8.70   <br> 128     1000          2.45           9.30         2.50     	       2.51        	0.20   		2.55    		9.30   <br> 256     1000          3.32           8.77         3.37     	       3.39        	0.23   		3.58    		8.77   <br> 512     1000          3.49           10.95        3.54     	       3.62        	0.54   		8.34    		10.95  <br> 1024    1000          3.86           9.04         3.90     	       3.92        	0.16   		3.96    		9.04   <br> 2048    1000          4.35           10.50        4.40     	       4.43        	0.31   		4.59    		10.50  <br> 4096    1000          5.24           13.08        5.34     	       5.41        	0.42   		8.50    		13.08  <br> 8192    1000          6.53           13.36        6.59     	       6.63        	0.32   		7.04    		13.36  <br> 16384   1000          9.46           15.45        9.75     	       9.81        	0.42   		13.52   		15.45  <br> 32768   1000          16.40          22.62        16.48    	       16.59       	0.43   		19.85   		22.62  <br> 65536   1000          26.33          33.55        26.40    	       26.51       	0.43   		29.10   		33.55  <br> 131072  1000          46.36          51.55        46.44    	       46.52       	0.30   		48.50   		51.55  <br> 262144  1000          91.07          97.84        92.16    	       92.24       	0.47   		96.19   		97.84  <br> 524288  1000          172.58         192.28       174.08   	       174.12      	0.42   		177.00  		192.28 <br> 1048576 1000          338.52         345.76       339.28   	       339.31      	0.27   		340.43  		345.76 <br> 2097152 1000          669.73         678.61       670.64   	       670.70      	0.32   		673.13  		678.61 <br> 4194304 1000          1332.97        1346.43      1334.15  	       1334.43     	0.98   		1340.49 		1346.43<br> 8388608 1000          2679.61        2705.95      2681.46  	       2681.85     	1.01   		2686.87 		2705.95<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>

<h3 id="rdma-share-1"><a href="#rdma-share-1" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="海光-1"><a href="#海光-1" class="headerlink" title="海光"></a>海光</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -d mlx5_0 -F --report_gbits -s 8388608<br>ib_send_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_send_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75</span><br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 236[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x014d PSN 0xddda08<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br> remote address: LID 0000 QPN 0x00f4 PSN 0x4628e4<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 8388608 1000          1599.23        9609.64      4285.57  	       4238.79     	383.24 		5101.01 		9609.64<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="寒武纪-1"><a href="#寒武纪-1" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -R  -d mlx5_0 -a -F<br>ib_send_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F  <br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_send_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F  </span><br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 236[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05bc PSN 0x99949a<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x0049 PSN 0x99949a<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.15           4.65         2.20     	       2.21        	0.09   		2.36    		4.65   <br> 4       1000          2.16           4.76         2.20     	       2.22        	0.09   		2.46    		4.76   <br> 8       1000          2.16           6.18         2.20     	       2.21        	0.07   		2.36    		6.18   <br> 16      1000          2.17           4.49         2.21     	       2.22        	0.07   		2.35    		4.49   <br> 32      1000          2.17           5.14         2.22     	       2.23        	0.07   		2.39    		5.14   <br> 64      1000          2.22           5.59         2.27     	       2.28        	0.10   		2.44    		5.59   <br> 128     1000          2.26           5.88         2.32     	       2.34        	0.13   		2.58    		5.88   <br> 256     1000          2.96           6.57         3.04     	       3.06        	0.15   		3.30    		6.57   <br> 512     1000          3.05           6.01         3.13     	       3.16        	0.16   		3.47    		6.01   <br> 1024    1000          3.18           6.05         3.26     	       3.30        	0.11   		3.55    		6.05   <br> 2048    1000          3.29           7.79         3.39     	       3.43        	0.14   		3.67    		7.79   <br> 4096    1000          3.44           5.65         3.61     	       3.65        	0.15   		3.96    		5.65   <br> 8192    1000          3.82           7.82         3.91     	       3.92        	0.08   		4.13    		7.82   <br> 16384   1000          4.63           9.46         4.81     	       4.84        	0.18   		5.22    		9.46   <br> 32768   1000          6.05           9.41         6.25     	       6.26        	0.15   		6.57    		9.41   <br> 65536   1000          8.87           20.70        9.09     	       9.11        	0.37   		9.54    		20.70  <br> 131072  1000          14.72          18.14        15.04    	       15.06       	0.22   		16.38   		18.14  <br> 262144  1000          25.99          28.81        26.47    	       26.47       	0.23   		27.51   		28.81  <br> 524288  1000          48.76          51.99        49.31    	       49.37       	0.32   		50.85   		51.99  <br> 1048576 1000          94.59          98.70        95.50    	       95.56       	0.44   		97.32   		98.70  <br> 2097152 1000          186.29         196.66       187.26   	       187.33      	0.58   		189.59  		196.66 <br> 4194304 1000          369.17         374.04       371.02   	       371.12      	0.77   		373.40  		374.04 <br> 8388608 1000          735.49         743.62       738.10   	       738.25      	1.04   		741.17  		743.62 <br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="NV-1"><a href="#NV-1" class="headerlink" title="NV"></a>NV</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_send_lat -R  -d mlx5_0 -a -F<br>ib_send_lat -R  -d mlx5_0 -i 1 10.56.217.71  -a -F  <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_send_lat -R  -d mlx5_0 -i 1 10.56.217.71  -a -F </span><br>---------------------------------------------------------------------------------------<br>                    Send Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Max inline data : 236[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01ee PSN 0xc891f6<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br> remote address: LID 0000 QPN 0x0131 PSN 0xb9f04a<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.44           9.11         2.57     	       2.59        	0.27   		2.74    		9.11   <br> 4       1000          2.37           4.84         2.41     	       2.42        	0.06   		2.53    		4.84   <br> 8       1000          2.43           6.41         2.47     	       2.48        	0.14   		2.58    		6.41   <br> 16      1000          2.44           9.41         2.48     	       2.50        	0.25   		2.60    		9.41   <br> 32      1000          2.38           9.57         2.42     	       2.45        	0.32   		2.60    		9.57   <br> 64      1000          2.46           9.43         2.51     	       2.56        	0.51   		5.89    		9.43   <br> 128     1000          2.55           10.31        2.60     	       2.66        	0.52   		6.19    		10.31  <br> 256     1000          3.43           8.41         3.47     	       3.50        	0.29   		3.72    		8.41   <br> 512     1000          3.58           7.22         3.64     	       3.66        	0.13   		3.89    		7.22   <br> 1024    1000          3.93           9.15         3.98     	       4.01        	0.23   		4.30    		9.15   <br> 2048    1000          4.46           10.66        4.52     	       4.54        	0.20   		4.73    		10.66  <br> 4096    1000          5.36           13.27        5.48     	       5.55        	0.56   		8.80    		13.27  <br> 8192    1000          6.71           12.64        6.78     	       6.84        	0.39   		9.07    		12.64  <br> 16384   1000          9.59           15.35        9.94     	       9.99        	0.39   		13.17   		15.35  <br> 32768   1000          16.73          23.19        16.83    	       16.92       	0.41   		18.51   		23.19  <br> 65536   1000          26.99          33.98        27.08    	       27.19       	0.53   		29.72   		33.98  <br> 131072  1000          47.57          54.78        47.68    	       47.75       	0.35   		49.64   		54.78  <br> 262144  1000          92.16          97.14        93.27    	       93.31       	0.31   		94.97   		97.14  <br> 524288  1000          175.63         184.12       176.77   	       176.81      	0.60   		180.64  		184.12 <br> 1048576 1000          343.29         351.31       344.19   	       344.28      	0.55   		347.31  		351.31 <br> 2097152 1000          678.72         685.71       679.66   	       679.81      	0.63   		682.79  		685.71 <br> 4194304 1000          1349.68        1361.09      1351.50  	       1352.04     	1.57   		1357.84 		1361.09<br> 8388608 1000          2698.65        2711.26      2701.94  	       2702.51     	2.45   		2709.45 		2711.26<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h2 id="ib-write-bw带宽测试"><a href="#ib-write-bw带宽测试" class="headerlink" title="ib_write_bw带宽测试"></a>ib_write_bw带宽测试</h2><h3 id="默认-2"><a href="#默认-2" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp-2"><a href="#海光2-amp-2" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><p>1</p>
<p>2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_bw -R  -d mlx5_0 -a -F<br>ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.241 -a -F <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@disai-hygon-2:~$ ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.241 -a -F<br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01da PSN 0xdc79e0<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:250<br> remote address: LID 0000 QPN 0x0078 PSN 0xe4c514<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          5000             5.49               5.48   		   2.873503<br> 4          5000             10.95              10.95  		   2.869347<br> 8          5000             21.96              21.82  		   2.860402<br> 16         5000             43.87              43.83  		   2.872743<br> 32         5000             87.63              87.11  		   2.854327<br> 64         5000             175.05             174.70 		   2.862285<br> 128        5000             352.29             351.91 		   2.882847<br> 256        5000             702.81             698.53 		   2.861171<br> 512        5000             1400.37            1397.18		   2.861416<br> 1024       5000             2807.74            2803.45		   2.870731<br> 2048       5000             5373.66            5372.01		   2.750467<br> 4096       5000             5930.53            5930.17		   1.518123<br> 8192       5000             5989.84            5989.30		   0.766631<br> 16384      5000             6033.01            6032.08		   0.386053<br> 32768      5000             6059.52            6059.13		   0.193892<br> 65536      5000             6072.83            6072.66		   0.097163<br> 131072     5000             6079.64            6079.55		   0.048636<br> 262144     5000             6083.11            6083.02		   0.024332<br> 524288     5000             6084.78            6084.74		   0.012169<br> 1048576    5000             6085.73            6085.61		   0.006086<br> 2097152    5000             6086.11            6086.03		   0.003043<br> 4194304    5000             6086.25            6086.23		   0.001522<br> 8388608    5000             6086.35            6086.33		   0.000761<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="寒武纪2-amp-2"><a href="#寒武纪2-amp-2" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪1</p>
<p>寒武纪2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_bw -R  -d mlx5_0 -a -F<br>ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.251 -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-Cambricon-2:~$ ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.251 -a -F  <br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0650 PSN 0x8ff343<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:248<br> remote address: LID 0000 QPN 0x0058 PSN 0x55ad5b<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:251<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          5000             11.14              11.07  		   5.801315<br> 4          5000             26.82              26.56  		   6.963417<br> 8          5000             53.49              52.90  		   6.933529<br> 16         5000             107.55             106.63 		   6.988051<br> 32         5000             215.11             213.80 		   7.005785<br> 64         5000             425.59             418.93 		   6.863765<br> 128        5000             846.63             840.81 		   6.887941<br> 256        5000             1653.48            1627.24		   6.665165<br> 512        5000             3255.95            3227.59		   6.610111<br> 1024       5000             6133.47            6058.19		   6.203585<br> 2048       5000             9953.37            9920.82		   5.079459<br> 4096       5000             10906.92            10893.36		   2.788699<br> 8192       5000             10936.32            10928.30		   1.398822<br> 16384      5000             10951.12            10944.93		   0.700476<br> 32768      5000             10962.87            10962.39		   0.350796<br> 65536      5000             10961.47            10959.98		   0.175360<br> 131072     5000             10956.56            10955.85		   0.087647<br> 262144     5000             10954.50            10953.30		   0.043813<br> 524288     5000             10950.07            10949.63		   0.021899<br> 1048576    5000             10954.88            10953.37		   0.010953<br> 2097152    5000             10948.91            10947.91		   0.005474<br> 4194304    5000             10943.88            10943.35		   0.002736<br> 8388608    5000             10944.67            10943.91		   0.001368<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="NV-amp-2"><a href="#NV-amp-2" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_bw -R  -d mlx5_0 -a -F<br>ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.245  -a -F  <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-4090-2:~/nccl_test/nccl-tests$ ib_write_bw -R  -d mlx5_0 -i 1 192.168.2.245  -a -F <br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 0[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01e4 PSN 0xab6e7<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br> remote address: LID 0000 QPN 0x0123 PSN 0x762bbe<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          5000             6.73               6.67   		   3.496033<br> 4          5000             20.27              20.07  		   5.260603<br> 8          5000             40.85              40.72  		   5.337253<br> 16         5000             100.29             97.25  		   6.373204<br> 32         5000             202.97             199.41 		   6.534406<br> 64         5000             401.18             380.60 		   6.235782<br> 128        5000             783.94             768.07 		   6.292036<br> 256        5000             1457.57            1433.55		   5.871804<br> 512        5000             2256.15            2240.20		   4.587924<br> 1024       5000             2670.32            2662.19		   2.726086<br> 2048       5000             2843.92            2837.60		   1.452852<br> 4096       5000             2911.24            2908.66		   0.744618<br> 8192       5000             2958.11            2957.59		   0.378571<br> 16384      5000             2986.16            2986.08		   0.191109<br> 32768      5000             3005.56            3004.86		   0.096156<br> 65536      5000             3011.61            3011.00		   0.048176<br> 131072     5000             3014.33            3014.33		   0.024115<br> 262144     5000             3015.81            3015.69		   0.012063<br> 524288     5000             3016.75            3016.65		   0.006033<br> 1048576    5000             3016.59            3016.32		   0.003016<br> 2097152    5000             3015.23            3015.21		   0.001508<br> 4194304    5000             3015.19            3015.13		   0.000754<br> 8388608    5000             3015.22            3012.43		   0.000377<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>

<h3 id="rdma-share-2"><a href="#rdma-share-2" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="NV-2"><a href="#NV-2" class="headerlink" title="NV"></a>NV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_bw -d mlx5_0 -F  -s 8388608<br>ib_write_bw -d mlx5_0 -F  -s 8388608 10.56.217.71<br></code></pre></td></tr></table></figure>





<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_write_bw -d mlx5_0 -F  -s 8388608 10.56.217.71</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01f0 PSN 0xb8adee RKey 0x1832f1 VAddr 0x007ebd6678a000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br> remote address: LID 0000 QPN 0x0133 PSN 0x4cba6e RKey 0x182bea VAddr 0x0077bc49c17000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 8388608    5000             2390.86            2376.85		   0.000297<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="海光-2"><a href="#海光-2" class="headerlink" title="海光"></a>海光</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_bw -d mlx5_0 -F --report_gbits -s 8388608<br>ib_write_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_write_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 0[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x014b PSN 0xf03762 RKey 0x1820df VAddr 0x007fce1c470000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br> remote address: LID 0000 QPN 0x00f2 PSN 0xbe7f8a RKey 0x1826e5 VAddr 0x007f9fc7ed6000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]</span><br> 8388608    5000             51.02              50.97  		   0.000759<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="寒武纪-2"><a href="#寒武纪-2" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_write_bw -R  -d mlx5_0 -i 1 10.56.217.78  -a -F </span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 0[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05be PSN 0x94df97<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x004b PSN 0x94df97<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          5000             7.89               7.81   		   4.093379<br> 4          5000             18.88              18.70  		   4.901774<br> 8          5000             37.84              37.63  		   4.932182<br> 16         5000             75.68              75.06  		   4.919003<br> 32         5000             152.52             151.26 		   4.956602<br> 64         5000             304.46             300.17 		   4.917929<br> 128        5000             597.44             591.34 		   4.844218<br> 256        5000             1217.85            1197.74		   4.905958<br> 512        5000             2398.80            2367.05		   4.847713<br> 1024       5000             4806.64            4756.40		   4.870555<br> 2048       5000             8689.97            8658.55		   4.433178<br> 4096       5000             10848.55            10833.89		   2.773477<br> 8192       5000             10842.71            10834.71		   1.386843<br> 16384      5000             10871.76            10869.13		   0.695624<br> 32768      5000             10881.97            10881.51		   0.348208<br> 65536      5000             10881.90            10879.29		   0.174069<br> 131072     5000             10895.19            10894.35		   0.087155<br> 262144     5000             10896.20            10895.23		   0.043581<br> 524288     5000             10896.96            10896.63		   0.021793<br> 1048576    5000             10900.23            10899.92		   0.010900<br> 2097152    5000             10893.30            10893.29		   0.005447<br> 4194304    5000             10891.89            10890.96		   0.002723<br> 8388608    5000             10890.38            10889.70		   0.001361<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h2 id="ib-write-lat时延测试"><a href="#ib-write-lat时延测试" class="headerlink" title="ib_write_lat时延测试"></a>ib_write_lat时延测试</h2><h3 id="默认-3"><a href="#默认-3" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp-3"><a href="#海光2-amp-3" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><p>1</p>
<p>2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_lat -R  -d mlx5_0 -a -F<br>ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.241  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@disai-hygon-2:~$ ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.241  -a -F <br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: OFF<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 220[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01dc PSN 0xc73bc3<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:250<br> remote address: LID 0000 QPN 0x007a PSN 0x43be5d<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.02           3.71         2.12     	       2.12        	0.03   		2.14    		3.71   <br> 4       1000          2.02           4.22         2.12     	       2.12        	0.00   		2.14    		4.22   <br> 8       1000          2.02           5.75         2.12     	       2.12        	0.00   		2.14    		5.75   <br> 16      1000          2.05           3.83         2.12     	       2.12        	0.00   		2.14    		3.83   <br> 32      1000          2.07           5.81         2.15     	       2.15        	0.00   		2.17    		5.81   <br> 64      1000          2.08           3.43         2.17     	       2.17        	0.00   		2.19    		3.43   <br> 128     1000          2.17           3.02         2.25     	       2.25        	0.00   		2.27    		3.02   <br> 256     1000          2.67           4.74         2.76     	       2.76        	0.03   		2.78    		4.74   <br> 512     1000          2.83           4.77         2.85     	       2.85        	0.00   		2.87    		4.77   <br> 1024    1000          2.91           5.50         3.01     	       3.01        	0.03   		3.04    		5.50   <br> 2048    1000          3.10           3.33         3.20     	       3.21        	0.00   		3.23    		3.33   <br> 4096    1000          3.44           4.92         3.56     	       3.56        	0.00   		3.59    		4.92   <br> 8192    1000          4.04           6.21         4.15     	       4.18        	0.04   		4.35    		6.21   <br> 16384   1000          5.24           5.54         5.33     	       5.33        	0.00   		5.48    		5.54   <br> 32768   1000          7.60           10.06        7.81     	       7.79        	0.05   		7.97    		10.06  <br> 65536   1000          12.27          15.34        12.39    	       12.40       	0.00   		12.52   		15.34  <br> 131072  1000          22.19          24.76        22.29    	       22.30       	0.08   		22.44   		24.76  <br> 262144  1000          41.37          66.40        41.45    	       41.46       	0.06   		41.50   		66.40  <br> 524288  1000          79.58          82.13        79.69    	       79.69       	0.04   		79.81   		82.13  <br> 1048576 1000          155.75         209.79       162.57   	       164.52      	7.90   		182.61  		209.79 <br> 2097152 1000          308.16         1834.61      319.90   	       351.04      	203.62 		1585.67 		1834.61<br> 4194304 1000          637.01         3282.46      650.15   	       666.07      	97.81  		1246.00 		3282.46<br> 8388608 1000          1613.34        7341.64      1753.70  	       2078.37     	693.13 		5286.40 		7341.64<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="寒武纪2-amp-3"><a href="#寒武纪2-amp-3" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪1</p>
<p>寒武纪2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_lat -R  -d mlx5_0 -a -F<br>ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.251  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-Cambricon-2:~$ ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.251  -a -F<br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: OFF<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 220[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0652 PSN 0xba0885<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:248<br> remote address: LID 0000 QPN 0x005a PSN 0x9df2dd<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:251<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.07           3.85         2.10     	       2.10        	0.03   		2.17    		3.85   <br> 4       1000          2.07           4.06         2.10     	       2.10        	0.00   		2.17    		4.06   <br> 8       1000          2.07           4.15         2.10     	       2.11        	0.04   		2.17    		4.15   <br> 16      1000          2.08           4.11         2.10     	       2.11        	0.03   		2.17    		4.11   <br> 32      1000          2.11           4.38         2.14     	       2.14        	0.03   		2.22    		4.38   <br> 64      1000          2.12           3.32         2.14     	       2.15        	0.03   		2.21    		3.32   <br> 128     1000          2.17           3.98         2.20     	       2.21        	0.03   		2.27    		3.98   <br> 256     1000          2.80           5.41         2.85     	       2.86        	0.04   		3.06    		5.41   <br> 512     1000          2.90           4.50         2.94     	       2.96        	0.03   		3.19    		4.50   <br> 1024    1000          3.02           5.91         3.08     	       3.12        	0.09   		3.33    		5.91   <br> 2048    1000          3.11           6.87         3.18     	       3.21        	0.04   		3.41    		6.87   <br> 4096    1000          3.28           5.77         3.41     	       3.44        	0.05   		3.71    		5.77   <br> 8192    1000          3.66           5.28         3.83     	       3.82        	0.03   		3.97    		5.28   <br> 16384   1000          4.36           6.35         4.51     	       4.53        	0.06   		4.75    		6.35   <br> 32768   1000          5.78           8.26         5.87     	       5.89        	0.08   		6.12    		8.26   <br> 65536   1000          8.61           10.20        8.75     	       8.78        	0.06   		9.00    		10.20  <br> 131072  1000          14.38          16.20        14.66    	       14.68       	0.05   		15.05   		16.20  <br> 262144  1000          25.64          28.93        26.11    	       26.14       	0.13   		27.27   		28.93  <br> 524288  1000          48.35          50.50        48.88    	       48.90       	0.12   		50.15   		50.50  <br> 1048576 1000          94.00          107.43       94.79    	       94.84       	0.21   		96.43   		107.43 <br> 2097152 1000          185.06         189.19       186.12   	       186.16      	0.20   		187.78  		189.19 <br> 4194304 1000          367.62         371.61       369.13   	       369.19      	0.39   		371.20  		371.61 <br> 8388608 1000          732.14         738.09       734.47   	       734.52      	0.68   		737.20  		738.09 <br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="NV-amp-3"><a href="#NV-amp-3" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>233</p>
<p>232</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_lat -R  -d mlx5_0 -a -F<br>ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.245 -a -F  <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunzhongyuan@DisAI-4090-2:~/nccl_test/nccl-tests$ ib_write_lat -R  -d mlx5_0 -i 1 192.168.2.245 -a -F<br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: OFF<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Max inline data : 220[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01e6 PSN 0x903f9a<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br> remote address: LID 0000 QPN 0x0125 PSN 0x74fffa<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.29           4.48         2.32     	       2.33        	0.00   		2.38    		4.48   <br> 4       1000          2.23           8.51         2.25     	       2.26        	0.14   		2.28    		8.51   <br> 8       1000          2.23           8.30         2.25     	       2.26        	0.20   		2.28    		8.30   <br> 16      1000          2.23           9.18         2.25     	       2.27        	0.22   		2.31    		9.18   <br> 32      1000          2.30           9.31         2.33     	       2.36        	0.33   		2.49    		9.31   <br> 64      1000          2.31           9.79         2.34     	       2.35        	0.20   		2.39    		9.79   <br> 128     1000          2.43           9.21         2.46     	       2.48        	0.31   		2.50    		9.21   <br> 256     1000          3.25           9.80         3.28     	       3.31        	0.32   		3.87    		9.80   <br> 512     1000          3.42           9.82         3.45     	       3.49        	0.28   		4.36    		9.82   <br> 1024    1000          3.86           7.41         3.90     	       3.90        	0.04   		3.98    		7.41   <br> 2048    1000          4.36           8.17         4.40     	       4.42        	0.07   		4.55    		8.17   <br> 4096    1000          5.23           12.05        5.33     	       5.38        	0.37   		7.90    		12.05  <br> 8192    1000          6.54           13.53        6.59     	       6.62        	0.23   		6.78    		13.53  <br> 16384   1000          9.67           15.91        9.74     	       9.77        	0.27   		10.60   		15.91  <br> 32768   1000          16.40          20.75        16.45    	       16.49       	0.15   		17.67   		20.75  <br> 65536   1000          26.32          34.28        26.37    	       26.50       	0.61   		31.00   		34.28  <br> 131072  1000          46.32          54.15        46.39    	       46.50       	0.55   		50.61   		54.15  <br> 262144  1000          91.08          98.04        92.14    	       92.21       	0.45   		95.63   		98.04  <br> 524288  1000          173.19         180.43       174.20   	       174.31      	0.56   		178.82  		180.43 <br> 1048576 1000          338.55         347.51       339.34   	       339.65      	0.94   		345.47  		347.51 <br> 2097152 1000          669.53         685.56       670.41   	       670.73      	1.09   		676.73  		685.56 <br> 4194304 1000          1333.04        1349.62      1334.39  	       1335.44     	2.07   		1343.52 		1349.62<br> 8388608 1000          2676.42        2709.09      2678.11  	       2678.63     	1.43   		2685.25 		2709.09<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h3 id="rdma-share-3"><a href="#rdma-share-3" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="NV-3"><a href="#NV-3" class="headerlink" title="NV"></a>NV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_lat -d mlx5_0 -F  -s 8388608<br>ib_write_lat -d mlx5_0 -F  -s 8388608 10.56.217.71<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_write_lat -d mlx5_0 -F  -s 8388608 10.56.217.71</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Max inline data : 220[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x01f1 PSN 0xf02d45 RKey 0x1832f1 VAddr 0x0077c2fe601000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br> remote address: LID 0000 QPN 0x0134 PSN 0x5608bc RKey 0x182bea VAddr 0x007d0535e3c000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 8388608 1000          2702.60        2854.49      2707.20  	       2710.28     	19.58  		2852.19 		2854.49<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>

<h4 id="海光-3"><a href="#海光-3" class="headerlink" title="海光"></a>海光</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_write_lat -d mlx5_0 -F --report_gbits -s 8388608<br>ib_write_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_write_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.75</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 220[B]<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x014e PSN 0xa6ee06 RKey 0x1820df VAddr 0x007f2206273000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br> remote address: LID 0000 QPN 0x00f5 PSN 0x7e725a RKey 0x1826e5 VAddr 0x007fddab8ae000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 8388608 1000          2388.58        5709.59      4332.45  	       4298.28     	383.91 		5146.24 		5709.59<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="寒武纪-3"><a href="#寒武纪-3" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#mofed-test-cx5-bond-pod1执行</span><br>ib_write_lat -R  -d mlx5_0 -i 1 -a -F <br><span class="hljs-comment">#mofed-test-cx5-bond-pod2执行，ip为mofed-test-cx5-bond-pod1中net1的ip</span><br>ib_write_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_write_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F </span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Write Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Max inline data : 220[B]<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05c0 PSN 0x3d9d90<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x004e PSN 0x3d9d90<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          2.16           3.73         2.19     	       2.19        	0.04   		2.24    		3.73   <br> 4       1000          2.16           3.34         2.19     	       2.19        	0.04   		2.26    		3.34   <br> 8       1000          2.17           4.67         2.19     	       2.19        	0.07   		2.25    		4.67   <br> 16      1000          2.16           5.15         2.19     	       2.20        	0.09   		2.28    		5.15   <br> 32      1000          2.19           3.57         2.22     	       2.23        	0.05   		2.30    		3.57   <br> 64      1000          2.21           3.72         2.24     	       2.24        	0.03   		2.34    		3.72   <br> 128     1000          2.27           5.52         2.30     	       2.32        	0.09   		2.51    		5.52   <br> 256     1000          2.95           5.21         2.98     	       3.00        	0.09   		3.22    		5.21   <br> 512     1000          3.03           5.05         3.08     	       3.11        	0.10   		3.33    		5.05   <br> 1024    1000          3.15           6.70         3.22     	       3.26        	0.11   		3.45    		6.70   <br> 2048    1000          3.23           5.98         3.33     	       3.37        	0.12   		3.68    		5.98   <br> 4096    1000          3.43           6.20         3.62     	       3.64        	0.17   		3.96    		6.20   <br> 8192    1000          3.81           5.53         3.91     	       3.92        	0.09   		4.18    		5.53   <br> 16384   1000          4.52           7.58         4.68     	       4.69        	0.14   		4.87    		7.58   <br> 32768   1000          5.92           8.61         6.09     	       6.10        	0.10   		6.33    		8.61   <br> 65536   1000          8.75           11.25        8.90     	       8.93        	0.18   		10.24   		11.25  <br> 131072  1000          14.64          16.66        14.93    	       14.98       	0.21   		15.68   		16.66  <br> 262144  1000          26.08          28.90        26.37    	       26.41       	0.24   		27.76   		28.90  <br> 524288  1000          48.71          51.17        49.25    	       49.31       	0.33   		50.75   		51.17  <br> 1048576 1000          94.38          146.66       95.43    	       95.48       	0.43   		97.35   		146.66 <br> 2097152 1000          186.17         190.91       187.29   	       187.35      	0.55   		189.39  		190.91 <br> 4194304 1000          369.12         374.62       371.04   	       371.12      	0.81   		373.55  		374.62 <br> 8388608 1000          735.62         743.15       738.11   	       738.22      	1.04   		740.97  		743.15 <br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>





<h2 id="ib-read-bw带宽测试"><a href="#ib-read-bw带宽测试" class="headerlink" title="ib_read_bw带宽测试"></a>ib_read_bw带宽测试</h2><h3 id="默认-4"><a href="#默认-4" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp-4"><a href="#海光2-amp-4" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><p>2</p>
<p>1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_bw -R  -d mlx5_0 -a -F<br>ib_read_bw -R  -d mlx5_0 -i 1 192.168.2.249  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ib_read_bw -R  -d mlx5_0 -i 1 192.168.2.249  -a -F<br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x007c PSN 0xd315ef<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br> remote address: LID 0000 QPN 0x00d3 PSN 0x78aa6e<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:249<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          1000             7.39               7.30   		   3.824692<br> 4          1000             14.80              14.77  		   3.871031<br> 8          1000             29.64              29.58  		   3.877635<br> 16         1000             59.18              59.10  		   3.873130<br> 32         1000             118.37             118.02 		   3.867139<br> 64         1000             236.74             235.84 		   3.864001<br> 128        1000             469.52             468.04 		   3.834224<br> 256        1000             940.61             939.48 		   3.848092<br> 512        1000             1743.94            1727.22		   3.537343<br> 1024       1000             3236.58            3235.07		   3.312714<br> 2048       1000             4748.81            4746.32		   2.430118<br> 4096       1000             5501.99            5500.83		   1.408213<br> 8192       1000             5946.23            5946.06		   0.761096<br> 16384      1000             6071.81            6071.21		   0.388558<br> 32768      1000             6084.14            6083.66		   0.194677<br> 65536      1000             6086.46            6086.22		   0.097379<br> 131072     1000             6089.04            6088.93		   0.048711<br> 262144     1000             6089.87            6089.84		   0.024359<br> 524288     1000             6089.94            6089.91		   0.012180<br> 1048576    1000             6090.02            6090.02		   0.006090<br> 2097152    1000             6089.79            6089.78		   0.003045<br> 4194304    1000             6089.76            6089.68		   0.001522<br> 8388608    1000             6089.41            6089.41		   0.000761<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="寒武纪2-amp-4"><a href="#寒武纪2-amp-4" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪2</p>
<p>寒武纪1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_bw -R  -d mlx5_0 -a -F<br>ib_read_bw -R  -d mlx5_0 -i 1 192.168.2.247  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ib_read_bw -R  -d mlx5_0 -i 1 192.168.2.247  -a -F <br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0149 PSN 0xa52024<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:254<br> remote address: LID 0000 QPN 0x0624 PSN 0xd97664<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:247<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          1000             7.51               7.46   		   3.912179<br> 4          1000             15.04              14.88  		   3.899687<br> 8          1000             29.67              29.62  		   3.882782<br> 16         1000             58.81              58.67  		   3.845073<br> 32         1000             118.15             117.79 		   3.859634<br> 64         1000             233.51             233.04 		   3.818185<br> 128        1000             458.89             457.18 		   3.745253<br> 256        1000             923.15             918.43 		   3.761882<br> 512        1000             1776.37            1768.92		   3.622748<br> 1024       1000             3328.64            3311.10		   3.390564<br> 2048       1000             6045.60            6036.33		   3.090602<br> 4096       1000             9364.63            9357.73		   2.395578<br> 8192       1000             10365.66            10365.37		   1.326767<br> 16384      1000             10411.01            10410.24		   0.666256<br> 32768      1000             10255.49            4331.13		   0.138596<br> 65536      1000             6341.21            6341.07		   0.101457<br> 131072     1000             8518.45            8516.08		   0.068129<br> 262144     1000             9044.75            8901.77		   0.035607<br> 524288     1000             9081.51            3604.61		   0.007209<br> 1048576    1000             8703.75            5167.14		   0.005167<br> 2097152    1000             8459.14            7728.63		   0.003864<br> 4194304    1000             8668.59            8404.49		   0.002101<br> 8388608    1000             8910.49            8661.59		   0.001083<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="NV-amp-4"><a href="#NV-amp-4" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>232</p>
<p>233</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_bw -R  -d mlx5_0 -a -F<br>ib_read_bw -R  -d mlx5_0 192.168.2.243  -a -F  <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">(base) sunzhongyuan@DisAI-4090-3:~$ ib_read_bw -R  -d mlx5_0 192.168.2.243  -a -F  <br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 5<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0127 PSN 0xddb8be<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br> remote address: LID 0000 QPN 0x01e8 PSN 0xaa8334<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          1000             7.15               6.99   		   3.666950<br> 4          1000             14.40              14.39  		   3.771996<br> 8          1000             28.71              28.70  		   3.761187<br> 16         1000             57.66              57.62  		   3.776274<br> 32         1000             114.70             114.33 		   3.746220<br> 64         1000             230.63             227.27 		   3.723628<br> 128        1000             426.71             421.14 		   3.449990<br> 256        1000             839.80             839.07 		   3.436818<br> 512        1000             1424.15            1423.56		   2.915453<br> 1024       1000             2221.26            2220.12		   2.273407<br> 2048       1000             2604.17            2604.12		   1.333309<br> 4096       1000             2856.50            2855.84		   0.731094<br> 8192       1000             2962.92            2962.82		   0.379241<br> 16384      1000             2991.24            2991.13		   0.191432<br> 32768      1000             2980.24            2980.21		   0.095367<br> 65536      1000             2985.35            2985.31		   0.047765<br> 131072     1000             3001.87            3001.87		   0.024015<br> 262144     1000             3016.52            3016.52		   0.012066<br> 524288     1000             3016.78            3016.78		   0.006034<br> 1048576    1000             3017.30            3017.30		   0.003017<br> 2097152    1000             3015.62            3015.62		   0.001508<br> 4194304    1000             3015.49            3015.44		   0.000754<br> 8388608    1000             3014.89            3005.67		   0.000376<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>

<h3 id="rdma-share-4"><a href="#rdma-share-4" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="NV-4"><a href="#NV-4" class="headerlink" title="NV"></a>NV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_bw -d mlx5_0 -F  -s 8388608<br>ib_read_bw -d mlx5_0 -F  -s 8388608 10.56.217.72<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_read_bw -d mlx5_0 -F  -s 8388608 10.56.217.72</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Outstand reads  : 16<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0135 PSN 0x87b40f OUT 0x10 RKey 0x182bea VAddr 0x0075b78204c000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br> remote address: LID 0000 QPN 0x01f2 PSN 0x20e8d6 OUT 0x10 RKey 0x1832f1 VAddr 0x0072db34d41000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 8388608    1000             2920.75            2920.75		   0.000365<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="海光-4"><a href="#海光-4" class="headerlink" title="海光"></a>海光</h4><p>2</p>
<p>1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_bw -d mlx5_0 -F --report_gbits -s 8388608<br>ib_read_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.76<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_read_bw -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.76</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Outstand reads  : 16<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x00f6 PSN 0xa21140 OUT 0x10 RKey 0x1826e5 VAddr 0x007f3ec0e5d000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br> remote address: LID 0000 QPN 0x014f PSN 0x7ab352 OUT 0x10 RKey 0x1820df VAddr 0x007f37a80e4000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[Gb/sec]    BW average[Gb/sec]   MsgRate[Mpps]</span><br> 8388608    1000             51.05              51.05  		   0.000761<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="寒武纪-4"><a href="#寒武纪-4" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#mofed-test-cx5-bond-pod2执行</span><br>ib_read_bw -R  -d mlx5_0 -i 1 -a -F <br><span class="hljs-comment">#mofed-test-cx5-bond-pod1执行，ip为mofed-test-cx5-bond-pod2中net1的ip</span><br>ib_read_bw -R  -d mlx5_0 -i 1 10.56.217.78 -a -F <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_read_bw -R  -d mlx5_0 -i 1 10.56.217.78 -a -F </span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read BW Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 128<br> CQ Moderation   : 100<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05c2 PSN 0x4ea1c9<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x0050 PSN 0x4ea1c9<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]</span><br> 2          1000             7.15               7.14   		   3.745089<br> 4          1000             14.40              14.31  		   3.750632<br> 8          1000             28.52              28.31  		   3.710647<br> 16         1000             57.03              56.55  		   3.705941<br> 32         1000             114.23             113.31 		   3.712835<br> 64         1000             228.79             227.23 		   3.722928<br> 128        1000             455.60             451.56 		   3.699213<br> 256        1000             902.11             884.42 		   3.622569<br> 512        1000             1688.75            1667.93		   3.415929<br> 1024       1000             3272.77            3264.23		   3.342572<br> 2048       1000             5770.26            5725.07		   2.931235<br> 4096       1000             9022.77            8996.38		   2.303074<br> 8192       1000             10355.21            10350.55		   1.324870<br> 16384      1000             10410.96            10410.20		   0.666253<br> 32768      1000             10361.77            4716.62		   0.150932<br> 65536      1000             6322.67            6322.49		   0.101160<br> 131072     1000             8946.73            8946.49		   0.071572<br> 262144     1000             9546.63            9090.27		   0.036361<br> 524288     1000             9448.09            5133.80		   0.010268<br> 1048576    1000             8773.05            8773.04		   0.008773<br> 2097152    1000             8481.43            8221.54		   0.004111<br> 4194304    1000             8896.21            8852.74		   0.002213<br> 8388608    1000             8679.52            8659.92		   0.001082<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h2 id="ib-read-lat时延测试"><a href="#ib-read-lat时延测试" class="headerlink" title="ib_read_lat时延测试"></a>ib_read_lat时延测试</h2><h3 id="默认-5"><a href="#默认-5" class="headerlink" title="默认"></a>默认</h3><h4 id="海光2-amp-5"><a href="#海光2-amp-5" class="headerlink" title="海光2&amp;"></a>海光2&amp;</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_lat -R  -d mlx5_0 -a -F<br>ib_read_lat -R  -d mlx5_0 -i 1 192.168.2.249  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ib_read_lat -R  -d mlx5_0 -i 1 192.168.2.249  -a -F  <br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x007e PSN 0x4f4b7c<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:241<br> remote address: LID 0000 QPN 0x00d5 PSN 0xfd1206<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:249<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          3.94           8.28         3.98     	       3.98        	0.00   		4.05    		8.28   <br> 4       1000          3.93           4.46         3.98     	       3.98        	0.00   		4.04    		4.46   <br> 8       1000          3.95           5.68         3.99     	       3.99        	0.00   		4.05    		5.68   <br> 16      1000          3.96           4.43         3.99     	       4.00        	0.00   		4.14    		4.43   <br> 32      1000          3.95           5.91         3.99     	       3.99        	0.00   		4.05    		5.91   <br> 64      1000          3.94           4.39         3.98     	       3.98        	0.00   		4.04    		4.39   <br> 128     1000          4.01           8.40         4.05     	       4.05        	0.00   		4.10    		8.40   <br> 256     1000          4.05           4.46         4.10     	       4.10        	0.00   		4.15    		4.46   <br> 512     1000          4.13           7.68         4.17     	       4.17        	0.00   		4.24    		7.68   <br> 1024    1000          4.28           4.84         4.31     	       4.31        	0.00   		4.37    		4.84   <br> 2048    1000          4.48           5.22         4.56     	       4.56        	0.00   		4.64    		5.22   <br> 4096    1000          4.81           9.85         4.92     	       4.92        	0.00   		5.03    		9.85   <br> 8192    1000          5.45           6.18         5.51     	       5.53        	0.00   		5.68    		6.18   <br> 16384   1000          6.70           7.43         6.76     	       6.76        	0.00   		6.91    		7.43   <br> 32768   1000          9.23           11.28        9.32     	       9.32        	0.00   		9.43    		11.28  <br> 65536   1000          14.20          15.50        14.29    	       14.31       	0.00   		14.56   		15.50  <br> 131072  1000          24.86          30.12        24.97    	       24.98       	0.15   		25.09   		30.12  <br> 262144  1000          44.85          49.81        44.99    	       45.00       	0.10   		45.27   		49.81  <br> 524288  1000          86.28          87.70        86.52    	       86.53       	0.00   		86.84   		87.70  <br> 1048576 1000          167.64         168.66       167.94   	       167.93      	0.00   		168.11  		168.66 <br> 2097152 1000          332.08         335.61       332.45   	       332.45      	0.00   		332.77  		335.61 <br> 4194304 1000          660.82         662.67       661.37   	       661.37      	0.00   		661.77  		662.67 <br> 8388608 1000          1317.00        1319.29      1317.90  	       1317.90     	0.03   		1318.55 		1319.29<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="寒武纪2-amp-5"><a href="#寒武纪2-amp-5" class="headerlink" title="寒武纪2&amp;"></a>寒武纪2&amp;</h4><p>寒武纪2</p>
<p>寒武纪1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_lat -R  -d mlx5_0 -i 1 -a -F<br>ib_read_lat -R  -d mlx5_0 -i 1 192.168.2.247  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ib_read_lat -R  -d mlx5_0 -i 1 192.168.2.247  -a -F <br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 3<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x014b PSN 0x51ff38<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:254<br> remote address: LID 0000 QPN 0x0626 PSN 0xed2ff9<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:247<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          4.03           8.16         4.08     	       4.10        	0.06   		4.46    		8.16   <br> 4       1000          4.03           7.44         4.08     	       4.10        	0.06   		4.45    		7.44   <br> 8       1000          4.03           6.55         4.09     	       4.11        	0.00   		4.47    		6.55   <br> 16      1000          4.04           5.40         4.09     	       4.11        	0.00   		4.47    		5.40   <br> 32      1000          4.04           5.90         4.10     	       4.12        	0.03   		4.49    		5.90   <br> 64      1000          4.06           6.74         4.11     	       4.13        	0.03   		4.48    		6.74   <br> 128     1000          4.11           5.93         4.16     	       4.18        	0.03   		4.53    		5.93   <br> 256     1000          4.16           6.78         4.22     	       4.25        	0.06   		4.66    		6.78   <br> 512     1000          4.26           5.89         4.31     	       4.34        	0.00   		4.56    		5.89   <br> 1024    1000          4.35           6.06         4.43     	       4.48        	0.00   		4.89    		6.06   <br> 2048    1000          4.48           8.72         4.58     	       4.64        	0.07   		5.01    		8.72   <br> 4096    1000          4.67           6.78         4.76     	       4.81        	0.00   		5.19    		6.78   <br> 8192    1000          5.05           7.16         5.18     	       5.21        	0.00   		5.51    		7.16   <br> 16384   1000          5.79           7.45         5.90     	       5.95        	0.00   		6.30    		7.45   <br> 32768   1000          7.29           11.43        7.48     	       7.53        	0.10   		7.90    		11.43  <br> 65536   1000          10.28          13.87        10.41    	       10.44       	0.09   		10.74   		13.87  <br> 131072  1000          16.26          19.45        16.40    	       16.44       	0.10   		16.89   		19.45  <br> 262144  1000          28.24          31.18        28.37    	       28.42       	0.09   		28.86   		31.18  <br> 524288  1000          52.20          55.25        52.35    	       52.42       	0.10   		53.45   		55.25  <br> 1048576 1000          100.10         103.76       100.25   	       100.33      	0.18   		101.53  		103.76 <br> 2097152 1000          196.35         199.51       196.80   	       196.89      	0.23   		198.83  		199.51 <br> 4194304 1000          388.76         829.89       540.15   	       559.89      	130.19 		828.78  		829.89 <br> 8388608 1000          773.29         10731.33      821.09   	       1590.91     	1014.50		6627.52 		10731.33<br>---------------------------------------------------------------------------------------<br></code></pre></td></tr></table></figure>



<h4 id="NV-amp-5"><a href="#NV-amp-5" class="headerlink" title="NV&amp;"></a>NV&amp;</h4><p>232</p>
<p>233</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_lat -R  -d mlx5_0 -a -F<br>ib_read_lat -R  -d mlx5_0 192.168.2.243  -a -F  <br></code></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">(base) sunzhongyuan@DisAI-4090-3:~$ ib_read_lat -R  -d mlx5_0 192.168.2.243  -a -F  <br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> PCIe relax order: ON<br> ibv_wr* API     : ON<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 5<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0129 PSN 0x1cd907<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:245<br> remote address: LID 0000 QPN 0x01ea PSN 0xe24d16<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:02:243<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          4.33           13.32        4.42     	       4.44        	0.24   		4.74    		13.32  <br> 4       1000          4.32           14.01        4.40     	       4.41        	0.00   		4.72    		14.01  <br> 8       1000          4.32           14.54        4.41     	       4.42        	0.03   		4.75    		14.54  <br> 16      1000          4.34           14.36        4.43     	       4.44        	0.00   		4.73    		14.36  <br> 32      1000          4.36           4.75         4.45     	       4.46        	0.00   		4.70    		4.75   <br> 64      1000          4.40           11.87        4.49     	       4.49        	0.03   		4.77    		11.87  <br> 128     1000          4.54           13.76        4.61     	       4.62        	0.07   		4.97    		13.76  <br> 256     1000          4.62           5.12         4.71     	       4.70        	0.00   		4.96    		5.12   <br> 512     1000          4.76           10.82        4.86     	       4.87        	0.06   		5.15    		10.82  <br> 1024    1000          5.12           11.78        5.21     	       5.21        	0.00   		5.35    		11.78  <br> 2048    1000          5.53           12.48        5.71     	       5.72        	0.00   		6.00    		12.48  <br> 4096    1000          6.39           14.26        6.50     	       6.50        	0.00   		6.68    		14.26  <br> 8192    1000          7.81           22.13        7.90     	       7.92        	0.34   		8.19    		22.13  <br> 16384   1000          11.14          20.23        11.24    	       11.26       	0.20   		11.59   		20.23  <br> 32768   1000          18.20          28.95        18.28    	       18.30       	0.17   		18.61   		28.95  <br> 65536   1000          27.58          32.04        27.72    	       27.74       	0.13   		28.00   		32.04  <br> 131072  1000          47.61          52.24        47.74    	       47.76       	0.22   		48.09   		52.24  <br> 262144  1000          91.00          94.61        93.19    	       93.32       	0.15   		93.98   		94.61  <br> 524288  1000          173.31         182.56       174.06   	       174.20      	0.42   		176.37  		182.56 <br> 1048576 1000          337.79         344.39       338.66   	       338.72      	0.20   		339.83  		344.39 <br> 2097152 1000          670.59         681.06       672.23   	       672.34      	0.30   		674.34  		681.06 <br> 4194304 1000          1334.09        1348.28      1337.06  	       1337.18     	0.78   		1342.50 		1348.28<br> 8388608 1000          2674.01        2690.96      2681.01  	       2681.04     	0.90   		2685.45 		2690.96<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>

<h3 id="rdma-share-5"><a href="#rdma-share-5" class="headerlink" title="rdma_share"></a>rdma_share</h3><h4 id="NV-5"><a href="#NV-5" class="headerlink" title="NV"></a>NV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_lat -d mlx5_0 -F -s 8388608<br>ib_read_lat -d mlx5_0 -F -s 8388608 10.56.217.72<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_read_lat -d mlx5_0 -F -s 8388608 10.56.217.72</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Outstand reads  : 16<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x0136 PSN 0x70ab96 OUT 0x10 RKey 0x182bea VAddr 0x0070e38bef7000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:71<br> remote address: LID 0000 QPN 0x01f3 PSN 0x10559d OUT 0x10 RKey 0x1832f1 VAddr 0x007d0e8988a000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:72<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 8388608 1000          2709.26        2731.17      2722.01  	       2722.04     	0.85   		2724.25 		2731.17<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="海光-5"><a href="#海光-5" class="headerlink" title="海光"></a>海光</h4><p>2</p>
<p>1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ib_read_lat -d mlx5_0 -F --report_gbits -s 8388608<br>ib_read_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.76<br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod1 /]<span class="hljs-comment"># ib_read_lat -d mlx5_0 -F --report_gbits -s 8388608 10.56.217.76</span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 6<br> Outstand reads  : 16<br> rdma_cm QPs	 : OFF<br> Data ex. method : Ethernet<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x00f7 PSN 0xe65dce OUT 0x10 RKey 0x1826e5 VAddr 0x007f3a88e1d000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:75<br> remote address: LID 0000 QPN 0x0150 PSN 0xce186b OUT 0x10 RKey 0x1820df VAddr 0x007f0bee248000<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:76<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 8388608 1000          1317.91        1321.34      1318.71  	       1318.77     	0.40   		1319.99 		1321.34<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h4 id="寒武纪-5"><a href="#寒武纪-5" class="headerlink" title="寒武纪"></a>寒武纪</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#mofed-test-cx5-bond-pod2执行</span><br>ib_read_lat -R  -d mlx5_0 -i 1 -a -F <br><span class="hljs-comment">#mofed-test-cx5-bond-pod1执行，ip为mofed-test-cx5-bond-pod2中net1的ip</span><br>ib_read_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F <br></code></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@mofed-test-cx5-bond-pod2 /]<span class="hljs-comment"># ib_read_lat -R  -d mlx5_0 -i 1 10.56.217.78  -a -F </span><br>---------------------------------------------------------------------------------------<br>                    RDMA_Read Latency Test<br> Dual-port       : OFF		Device         : mlx5_0<br> Number of qps   : 1		Transport <span class="hljs-built_in">type</span> : IB<br> Connection <span class="hljs-built_in">type</span> : RC		Using SRQ      : OFF<br> TX depth        : 1<br> Mtu             : 1024[B]<br> Link <span class="hljs-built_in">type</span>       : Ethernet<br> GID index       : 4<br> Outstand reads  : 16<br> rdma_cm QPs	 : ON<br> Data ex. method : rdma_cm<br>---------------------------------------------------------------------------------------<br> <span class="hljs-built_in">local</span> address: LID 0000 QPN 0x05c4 PSN 0xaf7048<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:74<br> remote address: LID 0000 QPN 0x0052 PSN 0xaf7048<br> GID: 00:00:00:00:00:00:00:00:00:00:255:255:10:56:217:78<br>---------------------------------------------------------------------------------------<br> <span class="hljs-comment">#bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec] </span><br> 2       1000          4.04           7.35         4.08     	       4.10        	0.07   		4.44    		7.35   <br> 4       1000          4.04           6.81         4.09     	       4.10        	0.06   		4.43    		6.81   <br> 8       1000          4.04           6.11         4.09     	       4.11        	0.07   		4.47    		6.11   <br> 16      1000          4.05           6.59         4.10     	       4.12        	0.10   		4.48    		6.59   <br> 32      1000          4.05           6.30         4.10     	       4.12        	0.06   		4.42    		6.30   <br> 64      1000          4.07           6.51         4.11     	       4.13        	0.09   		4.48    		6.51   <br> 128     1000          4.12           6.70         4.18     	       4.20        	0.09   		4.58    		6.70   <br> 256     1000          4.18           6.86         4.23     	       4.26        	0.14   		4.65    		6.86   <br> 512     1000          4.26           5.88         4.31     	       4.35        	0.11   		4.75    		5.88   <br> 1024    1000          4.36           6.71         4.42     	       4.47        	0.13   		4.87    		6.71   <br> 2048    1000          4.49           6.35         4.55     	       4.58        	0.09   		4.92    		6.35   <br> 4096    1000          4.68           7.07         4.75     	       4.81        	0.13   		5.15    		7.07   <br> 8192    1000          5.03           7.71         5.13     	       5.21        	0.15   		5.55    		7.71   <br> 16384   1000          5.78           7.64         5.87     	       5.93        	0.13   		6.34    		7.64   <br> 32768   1000          7.28           8.62         7.42     	       7.49        	0.16   		7.87    		8.62   <br> 65536   1000          10.28          12.13        10.38    	       10.43       	0.13   		10.79   		12.13  <br> 131072  1000          16.27          19.09        16.37    	       16.42       	0.17   		16.84   		19.09  <br> 262144  1000          28.26          31.65        28.36    	       28.43       	0.21   		28.85   		31.65  <br> 524288  1000          52.21          54.59        52.34    	       52.41       	0.22   		53.54   		54.59  <br> 1048576 1000          100.11         103.19       100.23   	       100.32      	0.28   		101.67  		103.19 <br> 2097152 1000          196.38         200.30       196.83   	       196.91      	0.37   		198.39  		200.30 <br> 4194304 1000          388.75         829.42       389.47   	       512.43      	155.48 		828.86  		829.42 <br> 8388608 1000          773.27         14315.84      795.45   	       929.08      	338.46 		2429.12 		14315.84<br>---------------------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/linux-rdma/perftest">linux-rdma/perftest: Infiniband Verbs Performance Tests (github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/edenlong/p/10273433.html">Infiniband 网络性能测试 - EdenLong - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bandaoyu/article/details/115798045">https://blog.csdn.net/bandaoyu/article/details/115798045</a></p>
</blockquote>

      </section>

      
      
        <nav class="article-nav">
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2024/06/22/kubernetes%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">kubernetes常见问题</h2>
        </a>
      
      <div class="card-text--row">Newer</div>
    </div>
  </article>
</div>
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2024/06/18/%E8%8B%B1%E4%BC%9F%E8%BE%BEnetwork-operator%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">英伟达network-operator源码阅读</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="/1642117062074.jpg" class="soft-size--round soft-style--box" alt="a-c-dream">
    
    
      <h2>a-c-dream</h2>
    
    
      <p>贵在坚持</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>109</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        13
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        0
      </div>
    </div>
  </div>
</section>

      

      

      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
        <li class="categorys-list-item">
          <a href="/categories/Android/">
            Android (5)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
            机器学习 (11)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/k8s/">
            k8s (26)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/%E7%AE%97%E6%B3%95/">
            算法 (9)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Hadoop/">
            Hadoop (4)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Hadoop-HBASE/">
            Hadoop HBASE (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/web/">
            web (3)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/HBASE/">
            HBASE (2)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/docker/">
            docker (10)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/hexo/">
            hexo (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">
            数据分析 (2)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
            数据结构 (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/%E7%88%AC%E8%99%AB/">
            爬虫 (1)
          </a>
        </li>
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      
    </div>
  </div>
</section>
    </div>
  </article>
</div>

        <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/a-c-dream/" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
      
    </div>
     
    <p>&copy; 2024 <a href="/" target="_blank">a-c-dream</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>


</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z">
      </path>
      <path
        d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z">
      </path>
      <path
        d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z">
      </path>
    </svg>
  </div>

  
    <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


      
        <!-- 尾部用户自定义相关内容 -->
<div>
    <link rel="stylesheet" href="/dist/APlayer.min.css">
    <div id="aplayer"></div>
    <script type="text/javascript" src="/dist/APlayer.min.js"></script>
    <script type="text/javascript" src="/js/diy/music.js"></script>
</div>

          <!-- <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"></script> -->
          

</body>

</html>